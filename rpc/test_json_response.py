#!/usr/bin/python
# -*- coding: utf-8 -*-

import pandas as pd
import json

def test_history():
    s = '{"jsonrpc":"2.0","id":"1234","result":{"ticket":[236170289,236393932,236397514,236397532,236398289,236399078,236399260,236400553,236400596,236401559,236401609,236401726,236401907,236401980,236445874,236446440,236446570,236447229,236447452,236447461,236447468,236447508,236447513,236447993,236448030,236448126,236448301,236448466,236448481,236448987,236449003,236449582,236449601,236449636,236450040,236450292,236450320,236450387,236450400,236450405],"opentime":[1402438280,1402653097,1402655636,1402655655,1402656238,1402656573,1402656632,1402657245,1402657258,1402657981,1402658020,1402661318,1402658188,1402658285,1402683681,1402684169,1402684214,1402684666,1402684901,1402684921,1402684935,1402684989,1402684997,1402685236,1402684997,1402685400,1402685400,1402685561,1402685561,1402685943,1402685943,1402686097,1402686097,1402686097,1402686527,1402686715,1402686715,1402686788,1402686805,1402686805],"type":[6,0,1,0,0,0,1,1,1,0,0,1,2,2,1,1,2,2,0,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,1,1],"volume":["0.01","0.01","0.01","0.01","0.01","0.01","0.01","0.01","0.01","0.01","0.01","0.01","0.01","0.01","0.01","0.01","0.01","0.01","0.01","0.05","0.05","0.2","0.01","0.01","0.19","0.01","0.04","0.01","0.03","0.01","0.02","0.01","0.01","0.03","0.03","0.01","0.02","0.02","0.01","0.01"],"symbol":["","EURUSD","EURUSD","EURUSD","EURUSD","EURUSD","EURUSD","EURUSD","EURUSD","EURUSD","EURUSD","EURUSD","EURUSD","EURUSD","EURUSD","EURUSD","EURUSD","EURUSD","EURUSD","EURUSD","EURUSD","EURUSD","EURUSD","EURUSD","EURUSD","EURUSD","EURUSD","EURUSD","EURUSD","EURUSD","EURUSD","EURUSD","EURUSD","EURUSD","EURUSD","EURUSD","EURUSD","EURUSD","EURUSD","EURUSD"],"openprice":["0","1.35667","1.35691","1.35701","1.35749","1.35704","1.35676","1.3576","1.35771","1.35755","1.3575","1.3574","1.3571","1.3563","1.35304","1.35299","1.3524","1.3523","1.35314","1.35316","1.35303","1.3533","1.35334","1.35279","1.35334","1.35273","1.35273","1.35255","1.35255","1.35239","1.35239","1.35248","1.35248","1.35248","1.3514","1.35237","1.35237","1.35237","1.35223","1.35223"],"stoploss":["0","1.35629","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0"],"takeprofit":["0","1.35807","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0"],"closetime":[1402438280,1402655572,1402655666,1402655711,1402656292,1402656650,1402657182,1402657269,1402657280,1402658027,1402658038,1402661385,1402661828,1402658333,1402683711,1402684179,1402684282,1402684712,1402684908,1402684930,1402684978,1402684992,1402685285,1402685241,1402685297,1402685440,1402685540,1402685577,1402685929,1402685965,1402686081,1402686116,1402686151,1402686230,1402686554,1402686728,1402686756,1402686801,1402686817,1402686854],"closeprice":["0","1.35668","1.35703","1.35678","1.35718","1.35685","1.35742","1.3579","1.35786","1.35737","1.35739","1.35757","1.35722","1.35768","1.35319","1.3531","1.35315","1.35305","1.35299","1.35303","1.35326","1.35315","1.35279","1.35294","1.35276","1.35245","1.35243","1.35249","1.35221","1.35221","1.35233","1.35234","1.35224","1.35216","1.35248","1.35218","1.35223","1.35223","1.35237","1.35239"],"commission":["0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0"],"swap":["0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0"],"profit":["5000","0.01","-0.12","-0.23","-0.31","-0.19","-0.66","-0.3","-0.15","-0.18","-0.11","-0.17","0","0","-0.15","-0.11","0","0","-0.15","-0.65","-1.15","-3","-0.55","-0.15","-11.02","-0.28","-1.2","-0.06","-1.02","-0.18","-0.12","-0.14","-0.24","-0.96","0","-0.19","-0.28","-0.28","-0.14","-0.16"],"comment":["Deposit","","","","","","","","","","","","cancelled","cancelled","","","cancelled","cancelled","","","","","to #236448030","","from #236447513","to #236448301","from #236448126","to #236448481","from #236448466","to #236449003","from #236448987","to #236449601","to #236449636","from #236449601","cancelled","to #236450320","from #236450292","","to #236450405","from #236450400"],"magicnumber":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]}}'

    #df = pd.read_json(s)
    
    dat = json.loads(s)
    df = pd.DataFrame(dat["result"])
    
    df = df[["ticket","opentime","type","volume","symbol","openprice","stoploss","takeprofit","closetime","closeprice","commission","swap","profit","comment","magicnumber"]]
    
    for col in ["opentime", "closetime"]:
        df[col] = pd.to_datetime(df[col]*1E9)
 
    print(df)
    print(df.dtypes)

test_history()